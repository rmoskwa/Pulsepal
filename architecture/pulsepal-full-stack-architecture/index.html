
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Complete API reference for Pulseq MATLAB functions">
      
      
      
        <link rel="canonical" href="https://rmoskwa.github.io/Pulsepal/architecture/pulsepal-full-stack-architecture/">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.16">
    
    
      
        <title>PulsePal Full-Stack Architecture Document - Pulseq MATLAB API Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.7e37652d.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="blue" data-md-color-accent="light-blue">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pulsepal-full-stack-architecture-document" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Pulseq MATLAB API Documentation" class="md-header__button md-logo" aria-label="Pulseq MATLAB API Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Pulseq MATLAB API Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              PulsePal Full-Stack Architecture Document
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../../index.md" class="md-tabs__link">
        
  
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../matlab_api/" class="md-tabs__link">
          
  
  
  API Reference

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Pulseq MATLAB API Documentation" class="md-nav__button md-logo" aria-label="Pulseq MATLAB API Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Pulseq MATLAB API Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../index.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    API Reference
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            API Reference
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    
    
    
    
      
      
        
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Functions
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Functions
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/addBlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    addBlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/addGradients/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    addGradients
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/addRamps/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    addRamps
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/align/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    align
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/applySoftDelay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    applySoftDelay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/applyToBlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    applyToBlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/applyToSeq/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    applyToSeq
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcAdcSeg/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcAdcSeg
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcDuration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcDuration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcMomentsBtensor/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcMomentsBtensor
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcPNS/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcPNS
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcRamp/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcRamp
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcRfBandwidth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcRfBandwidth
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcRfCenter/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcRfCenter
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calcRfPower/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calcRfPower
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/calculateKspacePP/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    calculateKspacePP
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/checkTiming/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    checkTiming
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/compressShape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    compressShape
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/compressShape_mat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    compressShape_mat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/conjugate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    conjugate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/convert/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    convert
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/decompressShape/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    decompressShape
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/duration/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    duration
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/evalLabels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    evalLabels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/EventLibrary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    EventLibrary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/findBlockByTime/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    findBlockByTime
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/findFlank/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    findFlank
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/flipGradAxis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    flipGradAxis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/fromRotMat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    fromRotMat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/getBlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    getBlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/getDefinition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    getDefinition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/getSupportedLabels/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    getSupportedLabels
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/getSupportedRfUse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    getSupportedRfUse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/install/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    install
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/isOctave/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    isOctave
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeAdc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeAdc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeAdiabaticPulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeAdiabaticPulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeArbitraryGrad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeArbitraryGrad
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeArbitraryRf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeArbitraryRf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeBlockPulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeBlockPulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeDelay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeDelay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeDigitalOutputPulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeDigitalOutputPulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeExtendedTrapezoid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeExtendedTrapezoid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeExtendedTrapezoidArea/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeExtendedTrapezoidArea
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeGaussPulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeGaussPulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeLabel/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeLabel
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeSincPulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeSincPulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeSLRpulse/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeSLRpulse
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeSoftDelay/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeSoftDelay
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeTrapezoid/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeTrapezoid
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/makeTrigger/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    makeTrigger
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/md5.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    md5
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/melodyToPitchesAndDurations.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    melodyToPitchesAndDurations
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/melodyToScale.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    melodyToScale
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/modGradAxis/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    modGradAxis
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/multiply/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    multiply
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/musicToSequence.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    musicToSequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/normalize/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    normalize
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/opts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    opts
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/paperPlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    paperPlot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/parsemr.md" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    parsemr
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/plot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    plot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/pts2waveform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    pts2waveform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/read/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    read
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/readasc/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    readasc
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/readBinary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    readBinary
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/restoreAdditionalShapeSamples/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    restoreAdditionalShapeSamples
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/rotate/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rotate
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/rotate3D/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    rotate3D
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/scaleGrad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    scaleGrad
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/SeqPlot/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    SeqPlot
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/Sequence/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Sequence
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/setBlock/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    setBlock
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/setDefinition/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    setDefinition
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/simRf/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    simRf
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/sound/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    sound
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/splitGradient/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    splitGradient
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/splitGradientAt/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    splitGradientAt
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/testReport/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    testReport
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/toRotMat/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    toRotMat
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/traj2grad/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    traj2grad
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/transform/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    transform
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/TransformFOV/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    TransformFOV
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/version/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    version
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/waveforms_and_times/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    waveforms_and_times
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/write/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    write
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/write_v141/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    write_v141
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../matlab_api/writeBinary/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    writeBinary
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#executive-summary" class="md-nav__link">
    <span class="md-ellipsis">
      Executive Summary
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-overview" class="md-nav__link">
    <span class="md-ellipsis">
      System Overview
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-purpose" class="md-nav__link">
    <span class="md-ellipsis">
      Core Purpose
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#key-architectural-principles" class="md-nav__link">
    <span class="md-ellipsis">
      Key Architectural Principles
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#technology-stack" class="md-nav__link">
    <span class="md-ellipsis">
      Technology Stack
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Technology Stack">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#core-technologies" class="md-nav__link">
    <span class="md-ellipsis">
      Core Technologies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supporting-technologies" class="md-nav__link">
    <span class="md-ellipsis">
      Supporting Technologies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#system-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      System Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="System Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#component-hierarchy" class="md-nav__link">
    <span class="md-ellipsis">
      Component Hierarchy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-flow-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Data Flow Architecture
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#core-components" class="md-nav__link">
    <span class="md-ellipsis">
      Core Components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Core Components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#main-agent-main_agentpy" class="md-nav__link">
    <span class="md-ellipsis">
      Main Agent (main_agent.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rag-service-rag_servicepy" class="md-nav__link">
    <span class="md-ellipsis">
      RAG Service (rag_service.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#session-management-dependenciespy" class="md-nav__link">
    <span class="md-ellipsis">
      Session Management (dependencies.py)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#tools-module-toolspy" class="md-nav__link">
    <span class="md-ellipsis">
      Tools Module (tools.py)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#database-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Database Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Database Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supabase-schema-design" class="md-nav__link">
    <span class="md-ellipsis">
      Supabase Schema Design
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Supabase Schema Design">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#primary-tables" class="md-nav__link">
    <span class="md-ellipsis">
      Primary Tables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#vector-search-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Vector Search Strategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#integration-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Integration Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Integration Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#external-service-integration" class="md-nav__link">
    <span class="md-ellipsis">
      External Service Integration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="External Service Integration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#google-gemini-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Google Gemini Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#supabase-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Supabase Integration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#google-embeddings-api" class="md-nav__link">
    <span class="md-ellipsis">
      Google Embeddings API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#performance-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Performance Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#optimization-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Optimization Strategies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#performance-metrics" class="md-nav__link">
    <span class="md-ellipsis">
      Performance Metrics
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#security-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Security Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Security Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#authentication-authorization" class="md-nav__link">
    <span class="md-ellipsis">
      Authentication &amp; Authorization
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#data-protection" class="md-nav__link">
    <span class="md-ellipsis">
      Data Protection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#privacy-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Privacy Considerations
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#deployment-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Deployment Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#development-environment" class="md-nav__link">
    <span class="md-ellipsis">
      Development Environment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#production-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Production Deployment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scaling-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Scaling Strategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#error-handling-resilience" class="md-nav__link">
    <span class="md-ellipsis">
      Error Handling &amp; Resilience
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Error Handling &amp; Resilience">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#error-categories" class="md-nav__link">
    <span class="md-ellipsis">
      Error Categories
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#recovery-strategies" class="md-nav__link">
    <span class="md-ellipsis">
      Recovery Strategies
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#testing-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Testing Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Testing Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#test-coverage-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Test Coverage Strategy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#test-organization" class="md-nav__link">
    <span class="md-ellipsis">
      Test Organization
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#monitoring-observability" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring &amp; Observability
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Monitoring &amp; Observability">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metrics-collection" class="md-nav__link">
    <span class="md-ellipsis">
      Metrics Collection
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#logging-strategy" class="md-nav__link">
    <span class="md-ellipsis">
      Logging Strategy
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#future-architecture-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      Future Architecture Considerations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Future Architecture Considerations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#planned-enhancements" class="md-nav__link">
    <span class="md-ellipsis">
      Planned Enhancements
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#scalability-roadmap" class="md-nav__link">
    <span class="md-ellipsis">
      Scalability Roadmap
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#maintenance-operations" class="md-nav__link">
    <span class="md-ellipsis">
      Maintenance &amp; Operations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Maintenance &amp; Operations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#regular-maintenance-tasks" class="md-nav__link">
    <span class="md-ellipsis">
      Regular Maintenance Tasks
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#monitoring-checklist" class="md-nav__link">
    <span class="md-ellipsis">
      Monitoring Checklist
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusion
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="pulsepal-full-stack-architecture-document">PulsePal Full-Stack Architecture Document<a class="headerlink" href="#pulsepal-full-stack-architecture-document" title="Permanent link">&para;</a></h1>
<h2 id="executive-summary">Executive Summary<a class="headerlink" href="#executive-summary" title="Permanent link">&para;</a></h2>
<p>PulsePal is an intelligent MRI sequence programming assistant built on a modern AI-powered architecture that combines Google Gemini 2.5 Flash's advanced reasoning capabilities with a sophisticated RAG (Retrieval-Augmented Generation) system backed by Supabase's vector database. The system follows a single-agent architecture with intelligent decision-making that routes 90% of queries through built-in knowledge and selectively uses RAG for specific Pulseq function documentation.</p>
<h2 id="system-overview">System Overview<a class="headerlink" href="#system-overview" title="Permanent link">&para;</a></h2>
<h3 id="core-purpose">Core Purpose<a class="headerlink" href="#core-purpose" title="Permanent link">&para;</a></h3>
<p>PulsePal assists MRI researchers, graduate students, and biomedical engineers in developing, debugging, and understanding Pulseq sequences through an intelligent conversational interface that provides both theoretical MRI physics knowledge and practical programming assistance.</p>
<h3 id="key-architectural-principles">Key Architectural Principles<a class="headerlink" href="#key-architectural-principles" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Intelligence-First Design</strong>: Leverages Gemini's built-in MRI physics knowledge for most queries</li>
<li><strong>Selective RAG Enhancement</strong>: Uses vector search only when specific Pulseq documentation is needed</li>
<li><strong>Single Agent Architecture</strong>: One intelligent agent handles all queries without delegation</li>
<li><strong>Session-Aware Context</strong>: Maintains conversation history and user preferences across interactions</li>
<li><strong>Dual Interface Support</strong>: Provides both CLI and web interfaces for different usage scenarios</li>
</ol>
<h2 id="technology-stack">Technology Stack<a class="headerlink" href="#technology-stack" title="Permanent link">&para;</a></h2>
<h3 id="core-technologies">Core Technologies<a class="headerlink" href="#core-technologies" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>LLM</strong>: Google Gemini 2.5 Flash (primary reasoning engine)</li>
<li><strong>Framework</strong>: PydanticAI (agent orchestration and tool management)</li>
<li><strong>Vector Database</strong>: Supabase with pgvector extension</li>
<li><strong>Embeddings</strong>: Google Embeddings API (768-dimensional vectors)</li>
<li><strong>Web Framework</strong>: Chainlit (web interface with streaming support)</li>
<li><strong>Language</strong>: Python 3.10+ with async/await support</li>
</ul>
<h3 id="supporting-technologies">Supporting Technologies<a class="headerlink" href="#supporting-technologies" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Session Management</strong>: Custom in-memory session store with 24-hour retention</li>
<li><strong>Logging</strong>: Python logging with conversation archival system</li>
<li><strong>Configuration</strong>: Pydantic-settings with environment variable management</li>
<li><strong>Authentication</strong>: API key-based auth with rate limiting (optional)</li>
<li><strong>Semantic Routing</strong>: Local transformer model for query classification</li>
</ul>
<h2 id="system-architecture">System Architecture<a class="headerlink" href="#system-architecture" title="Permanent link">&para;</a></h2>
<h3 id="component-hierarchy">Component Hierarchy<a class="headerlink" href="#component-hierarchy" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>PulsePal System
 User Interfaces
    CLI Interface (run_pulsepal.py)
    Web Interface (chainlit_app.py)
 Core Agent Layer
    Main Agent (main_agent.py)
    Dependencies (dependencies.py)
    Tools (tools.py)
 Service Layer
    RAG Service (rag_service.py)
    Session Manager
    Semantic Router (semantic_router.py)
    Settings Manager (settings.py)
 Data Layer
    Supabase Client (supabase_client.py)
    Embeddings Service (embeddings.py)
    Conversation Logger
 External Services
     Google Gemini API
     Google Embeddings API
     Supabase Vector Database
</code></pre></div>
<h3 id="data-flow-architecture">Data Flow Architecture<a class="headerlink" href="#data-flow-architecture" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Query Reception</strong></li>
<li>User submits query through CLI or web interface</li>
<li>Interface creates/retrieves session context</li>
<li>
<p>Query passed to main agent with session dependencies</p>
</li>
<li>
<p><strong>Intelligent Routing</strong></p>
</li>
<li>Semantic router analyzes query intent (100ms)</li>
<li>Determines if RAG search is needed (10% of queries)</li>
<li>
<p>Detects mentioned functions for potential validation</p>
</li>
<li>
<p><strong>Knowledge Retrieval</strong> (when needed)</p>
</li>
<li>RAG service performs hybrid search (vector + keyword)</li>
<li>Sources include API docs, examples, tutorials</li>
<li>
<p>Results formatted with source attribution</p>
</li>
<li>
<p><strong>Response Generation</strong></p>
</li>
<li>Gemini processes query with context</li>
<li>Validates functions if code generation requested</li>
<li>
<p>Generates comprehensive response</p>
</li>
<li>
<p><strong>Session Persistence</strong></p>
</li>
<li>Response logged to conversation history</li>
<li>Session context updated</li>
<li>Optional archival for important sessions</li>
</ol>
<h2 id="core-components">Core Components<a class="headerlink" href="#core-components" title="Permanent link">&para;</a></h2>
<h3 id="main-agent-main_agentpy">Main Agent (main_agent.py)<a class="headerlink" href="#main-agent-main_agentpy" title="Permanent link">&para;</a></h3>
<p>The central intelligence hub that orchestrates all PulsePal functionality:
- <strong>System Prompt</strong>: Comprehensive MRI physics and Pulseq expertise
- <strong>Tool Registration</strong>: Manages RAG search, validation, and code tools
- <strong>Session Management</strong>: Creates and maintains conversation context
- <strong>Response Generation</strong>: Leverages Gemini for intelligent responses</p>
<h3 id="rag-service-rag_servicepy">RAG Service (rag_service.py)<a class="headerlink" href="#rag-service-rag_servicepy" title="Permanent link">&para;</a></h3>
<p>Modern retrieval system with source-aware search capabilities:
- <strong>Multi-Source Search</strong>: API docs, examples, tutorials, community content
- <strong>Hybrid Search Strategy</strong>: Combines vector similarity with keyword matching
- <strong>Smart Result Formatting</strong>: Groups results by source with synthesis hints
- <strong>Performance Optimization</strong>: Query caching and result optimization</p>
<h3 id="session-management-dependenciespy">Session Management (dependencies.py)<a class="headerlink" href="#session-management-dependenciespy" title="Permanent link">&para;</a></h3>
<p>Sophisticated conversation and context management:
- <strong>Conversation History</strong>: Maintains up to 100 exchanges per session
- <strong>Language Detection</strong>: Tracks preferred programming language (MATLAB/Python)
- <strong>Code Examples</strong>: Stores and references generated code snippets
- <strong>Session Lifecycle</strong>: 24-hour retention with automatic cleanup</p>
<h3 id="tools-module-toolspy">Tools Module (tools.py)<a class="headerlink" href="#tools-module-toolspy" title="Permanent link">&para;</a></h3>
<p>Unified interface for agent capabilities:
- <strong>search_pulseq_knowledge</strong>: Intelligent RAG search with source selection
- <strong>validate_pulseq_function</strong>: Deterministic function validation
- <strong>verify_function_namespace</strong>: Checks function existence in database
- <strong>validate_code_block</strong>: Validates entire code segments</p>
<h2 id="database-architecture">Database Architecture<a class="headerlink" href="#database-architecture" title="Permanent link">&para;</a></h2>
<h3 id="supabase-schema-design">Supabase Schema Design<a class="headerlink" href="#supabase-schema-design" title="Permanent link">&para;</a></h3>
<h4 id="primary-tables">Primary Tables<a class="headerlink" href="#primary-tables" title="Permanent link">&para;</a></h4>
<ol>
<li><strong>pulseq_sequences</strong>: Complete sequence implementations</li>
<li>Full code storage with language specification</li>
<li>Classification system (family, contrast, trajectory)</li>
<li>Dependency tracking and architecture type</li>
<li>Feature arrays for smart filtering</li>
<li>
<p>Semantic embeddings for similarity search</p>
</li>
<li>
<p><strong>sequence_chunks</strong>: Code sections for granular retrieval</p>
</li>
<li>Universal 6-section pattern recognition</li>
<li>Function and concept extraction</li>
<li>Educational value assessment</li>
<li>
<p>Section-specific embeddings</p>
</li>
<li>
<p><strong>crawled_code</strong>: Supporting code and dependencies</p>
</li>
<li>Helper functions and utilities</li>
<li>Data files and calibration sequences</li>
<li>Documentation and tutorials</li>
<li>
<p>Cross-reference tracking</p>
</li>
<li>
<p><strong>api_reference</strong>: Authoritative function documentation</p>
</li>
<li>Complete function signatures</li>
<li>Parameter specifications</li>
<li>Return value documentation</li>
<li>Usage examples</li>
</ol>
<h3 id="vector-search-strategy">Vector Search Strategy<a class="headerlink" href="#vector-search-strategy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Embedding Model</strong>: Google's text-embedding-004 (768 dimensions)</li>
<li><strong>Similarity Metric</strong>: Cosine similarity with pgvector</li>
<li><strong>Hybrid Approach</strong>: Combines vector search with SQL full-text search</li>
<li><strong>Reranking</strong>: Optional cross-encoder for result refinement</li>
</ul>
<h2 id="integration-architecture">Integration Architecture<a class="headerlink" href="#integration-architecture" title="Permanent link">&para;</a></h2>
<h3 id="external-service-integration">External Service Integration<a class="headerlink" href="#external-service-integration" title="Permanent link">&para;</a></h3>
<h4 id="google-gemini-integration">Google Gemini Integration<a class="headerlink" href="#google-gemini-integration" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Model</strong>: gemini-2.5-flash with 0.1 temperature</li>
<li><strong>Context Window</strong>: 1M tokens for comprehensive understanding</li>
<li><strong>Safety Settings</strong>: Configured for technical content</li>
<li><strong>Rate Limiting</strong>: Automatic retry with exponential backoff</li>
</ul>
<h4 id="supabase-integration">Supabase Integration<a class="headerlink" href="#supabase-integration" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Connection Pooling</strong>: Persistent client with connection reuse</li>
<li><strong>RPC Functions</strong>: Custom PostgreSQL functions for complex queries</li>
<li><strong>Row-Level Security</strong>: Configured for multi-tenant support</li>
<li><strong>Backup Strategy</strong>: Automated daily backups with point-in-time recovery</li>
</ul>
<h4 id="google-embeddings-api">Google Embeddings API<a class="headerlink" href="#google-embeddings-api" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Batch Processing</strong>: Efficient batch embedding generation</li>
<li><strong>Caching Layer</strong>: Local cache for frequently embedded queries</li>
<li><strong>Fallback Strategy</strong>: Graceful degradation if service unavailable</li>
</ul>
<h2 id="performance-architecture">Performance Architecture<a class="headerlink" href="#performance-architecture" title="Permanent link">&para;</a></h2>
<h3 id="optimization-strategies">Optimization Strategies<a class="headerlink" href="#optimization-strategies" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Intelligent Query Routing</strong></li>
<li>90% queries handled with built-in knowledge (0ms retrieval)</li>
<li>10% requiring RAG search (500-1000ms retrieval)</li>
<li>
<p>Semantic routing decision in ~100ms</p>
</li>
<li>
<p><strong>Caching Mechanisms</strong></p>
</li>
<li>Session-level conversation cache</li>
<li>RAG result caching (15-minute TTL)</li>
<li>
<p>Embedding cache for common queries</p>
</li>
<li>
<p><strong>Lazy Loading</strong></p>
</li>
<li>Semantic router loaded on-demand</li>
<li>Cross-encoder reranker loaded when needed</li>
<li>
<p>Database connections established lazily</p>
</li>
<li>
<p><strong>Response Streaming</strong></p>
</li>
<li>Chainlit streaming for progressive display</li>
<li>Chunked response generation</li>
<li>Early result display while processing continues</li>
</ol>
<h3 id="performance-metrics">Performance Metrics<a class="headerlink" href="#performance-metrics" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Average Response Time</strong>: 1-2 seconds for built-in knowledge</li>
<li><strong>RAG-Enhanced Response</strong>: 2-3 seconds with documentation</li>
<li><strong>Session Creation</strong>: &lt;100ms</li>
<li><strong>Query Classification</strong>: ~100ms with semantic router</li>
</ul>
<h2 id="security-architecture">Security Architecture<a class="headerlink" href="#security-architecture" title="Permanent link">&para;</a></h2>
<h3 id="authentication-authorization">Authentication &amp; Authorization<a class="headerlink" href="#authentication-authorization" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>API Key Management</strong>: SHA-256 hashed keys with salt</li>
<li><strong>Rate Limiting</strong>: Per-user daily limits with Redis tracking</li>
<li><strong>Session Security</strong>: UUID4 session identifiers</li>
<li><strong>CORS Configuration</strong>: Restrictive origin policies</li>
</ul>
<h3 id="data-protection">Data Protection<a class="headerlink" href="#data-protection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Environment Variables</strong>: All secrets in .env files</li>
<li><strong>No Credential Storage</strong>: No passwords or keys in code</li>
<li><strong>Secure Communication</strong>: HTTPS for all external APIs</li>
<li><strong>Input Validation</strong>: Pydantic models for all inputs</li>
</ul>
<h3 id="privacy-considerations">Privacy Considerations<a class="headerlink" href="#privacy-considerations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Conversation Logging</strong>: Optional with user consent</li>
<li><strong>Data Retention</strong>: 30-day default with configurable policies</li>
<li><strong>PII Handling</strong>: No personal data in vector embeddings</li>
<li><strong>Audit Trail</strong>: Complete query and response logging</li>
</ul>
<h2 id="deployment-architecture">Deployment Architecture<a class="headerlink" href="#deployment-architecture" title="Permanent link">&para;</a></h2>
<h3 id="development-environment">Development Environment<a class="headerlink" href="#development-environment" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Local Setup</strong>: Docker Compose for services</li>
<li><strong>Hot Reload</strong>: Automatic agent reload on code changes</li>
<li><strong>Debug Mode</strong>: Verbose logging and error traces</li>
<li><strong>Test Data</strong>: Synthetic sequences for development</li>
</ul>
<h3 id="production-deployment">Production Deployment<a class="headerlink" href="#production-deployment" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Server Requirements</strong>: 4GB RAM, 2 CPU cores minimum</li>
<li><strong>Process Management</strong>: Gunicorn with multiple workers</li>
<li><strong>Load Balancing</strong>: Nginx reverse proxy</li>
<li><strong>Monitoring</strong>: Prometheus metrics and Grafana dashboards</li>
</ul>
<h3 id="scaling-strategy">Scaling Strategy<a class="headerlink" href="#scaling-strategy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Horizontal Scaling</strong>: Multiple agent instances</li>
<li><strong>Database Scaling</strong>: Supabase automatic scaling</li>
<li><strong>Cache Distribution</strong>: Redis for distributed caching</li>
<li><strong>CDN Integration</strong>: Static asset delivery</li>
</ul>
<h2 id="error-handling-resilience">Error Handling &amp; Resilience<a class="headerlink" href="#error-handling-resilience" title="Permanent link">&para;</a></h2>
<h3 id="error-categories">Error Categories<a class="headerlink" href="#error-categories" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>API Errors</strong>: Rate limits, authentication, timeouts</li>
<li><strong>Database Errors</strong>: Connection failures, query timeouts</li>
<li><strong>Session Errors</strong>: Corruption, expiration, overflow</li>
<li><strong>Validation Errors</strong>: Invalid functions, malformed code</li>
</ol>
<h3 id="recovery-strategies">Recovery Strategies<a class="headerlink" href="#recovery-strategies" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Automatic Retry</strong>: Exponential backoff for transient errors</li>
<li><strong>Fallback Mechanisms</strong>: Built-in knowledge when RAG fails</li>
<li><strong>Graceful Degradation</strong>: Reduced functionality vs. failure</li>
<li><strong>Error Reporting</strong>: Detailed logs with context</li>
</ul>
<h2 id="testing-architecture">Testing Architecture<a class="headerlink" href="#testing-architecture" title="Permanent link">&para;</a></h2>
<h3 id="test-coverage-strategy">Test Coverage Strategy<a class="headerlink" href="#test-coverage-strategy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Unit Tests</strong>: 85% coverage for core modules</li>
<li><strong>Integration Tests</strong>: API and database integration</li>
<li><strong>E2E Tests</strong>: Complete user workflows</li>
<li><strong>Performance Tests</strong>: Load and stress testing</li>
</ul>
<h3 id="test-organization">Test Organization<a class="headerlink" href="#test-organization" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code>tests/
 unit/           # Component-level tests
 integration/    # Service interaction tests
 e2e/           # User workflow tests
 fixtures/      # Shared test data
</code></pre></div>
<h2 id="monitoring-observability">Monitoring &amp; Observability<a class="headerlink" href="#monitoring-observability" title="Permanent link">&para;</a></h2>
<h3 id="metrics-collection">Metrics Collection<a class="headerlink" href="#metrics-collection" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Response Times</strong>: P50, P95, P99 latencies</li>
<li><strong>Error Rates</strong>: By category and severity</li>
<li><strong>Usage Patterns</strong>: Query types and frequencies</li>
<li><strong>Resource Usage</strong>: CPU, memory, database connections</li>
</ul>
<h3 id="logging-strategy">Logging Strategy<a class="headerlink" href="#logging-strategy" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Structured Logging</strong>: JSON format for analysis</li>
<li><strong>Log Levels</strong>: DEBUG, INFO, WARNING, ERROR, CRITICAL</li>
<li><strong>Conversation Archival</strong>: Searchable conversation history</li>
<li><strong>Performance Logging</strong>: Detailed timing information</li>
</ul>
<h2 id="future-architecture-considerations">Future Architecture Considerations<a class="headerlink" href="#future-architecture-considerations" title="Permanent link">&para;</a></h2>
<h3 id="planned-enhancements">Planned Enhancements<a class="headerlink" href="#planned-enhancements" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Multi-Agent Architecture</strong>: Specialized agents for different domains</li>
<li><strong>Advanced Caching</strong>: Distributed cache with Redis Cluster</li>
<li><strong>Real-time Collaboration</strong>: WebSocket support for shared sessions</li>
<li><strong>Plugin System</strong>: Extensible tool architecture</li>
</ol>
<h3 id="scalability-roadmap">Scalability Roadmap<a class="headerlink" href="#scalability-roadmap" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Microservices Migration</strong>: Separate RAG and agent services</li>
<li><strong>Event-Driven Architecture</strong>: Message queue integration</li>
<li><strong>Multi-Region Deployment</strong>: Geographic distribution</li>
<li><strong>Advanced Load Balancing</strong>: Smart routing based on load</li>
</ul>
<h2 id="maintenance-operations">Maintenance &amp; Operations<a class="headerlink" href="#maintenance-operations" title="Permanent link">&para;</a></h2>
<h3 id="regular-maintenance-tasks">Regular Maintenance Tasks<a class="headerlink" href="#regular-maintenance-tasks" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Database Optimization</strong>: Weekly VACUUM and ANALYZE</li>
<li><strong>Log Rotation</strong>: Daily rotation with 30-day retention</li>
<li><strong>Cache Cleanup</strong>: Hourly expired entry removal</li>
<li><strong>Session Cleanup</strong>: Daily removal of expired sessions</li>
</ul>
<h3 id="monitoring-checklist">Monitoring Checklist<a class="headerlink" href="#monitoring-checklist" title="Permanent link">&para;</a></h3>
<ul>
<li>API availability and response times</li>
<li>Database query performance</li>
<li>Error rate thresholds</li>
<li>Resource utilization trends</li>
<li>User satisfaction metrics</li>
</ul>
<h2 id="conclusion">Conclusion<a class="headerlink" href="#conclusion" title="Permanent link">&para;</a></h2>
<p>PulsePal's architecture represents a modern, scalable approach to AI-powered assistance that balances intelligence with performance. The system's strength lies in its intelligent routing mechanism that leverages built-in knowledge for most queries while maintaining the ability to access specific documentation when needed. This architecture ensures fast response times, high accuracy, and excellent user experience while remaining maintainable and extensible for future enhancements.</p>
<p>The combination of Google Gemini's advanced reasoning, Supabase's vector capabilities, and PydanticAI's robust framework creates a powerful platform for MRI sequence development assistance that serves both educational and practical needs of the MRI research community.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/pulseq/pulseq" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path fill="currentColor" d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.expand", "navigation.top", "search.suggest", "search.highlight", "content.code.copy", "content.code.annotate"], "search": "../../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.50899def.min.js"></script>
      
    
  </body>
</html>